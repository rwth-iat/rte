
/******************************************************************************
*
*   FILE
*   ----
*   genericHttpClient.c
*
*   History
*   -------
*   2013-08-07   File created
*
*******************************************************************************
*
*   This file is generated by the 'acplt_builder' command
*
******************************************************************************/


#ifndef OV_COMPILE_LIBRARY_kshttp
#define OV_COMPILE_LIBRARY_kshttp
#endif


#include "kshttp.h"
#include "config.h"

void kshttp_genericHttpClient_Callback(OV_INSTPTR_ov_domain instanceCalled, OV_INSTPTR_ov_domain instanceCalling);


OV_DLLFNCEXPORT OV_RESULT kshttp_genericHttpClient_beginCommunication_set(
	OV_INSTPTR_kshttp_genericHttpClient          thisCl,
	const OV_BOOL  value
) {
	kshttp_generateAndSendHttpMessage(thisCl->v_method, thisCl->v_serverHost, thisCl->v_serverPort, thisCl->v_requestUri, 0, NULL, Ov_PtrUpCast(kshttp_httpClientBase, thisCl), Ov_PtrUpCast(ov_domain, thisCl), &kshttp_genericHttpClient_Callback);

	return OV_ERR_OK;
}

void kshttp_genericHttpClient_Callback(OV_INSTPTR_ov_domain instanceCalled, OV_INSTPTR_ov_domain instanceCalling){
	OV_INSTPTR_kshttp_genericHttpClient	thisCl = Ov_DynamicPtrCast(kshttp_genericHttpClient, instanceCalling);

	if(thisCl->v_ServerResponse.contentLength != 0){
		thisCl->v_messageBody =  ov_database_malloc(thisCl->v_ServerResponse.contentLength+1);
		if(!thisCl->v_messageBody){
			kshttp_httpClientBase_reset(Ov_PtrUpCast(ksbase_ClientBase, thisCl));
			return;
		}
		memcpy(thisCl->v_messageBody, thisCl->v_ServerResponse.messageBody, thisCl->v_ServerResponse.contentLength);
		thisCl->v_messageBody[thisCl->v_ServerResponse.contentLength] = '\0';
	}
	kshttp_httpClientBase_reset(Ov_PtrUpCast(ksbase_ClientBase, thisCl));
	return;
}
