#******************************************************************************#
#* A lightweight Makefile to invoke the prebuild mechanism
#******************************************************************************#

#Lower case makro
lc = $(subst A,a,$(subst B,b,$(subst C,c,$(subst D,d,$(subst E,e,$(subst F,f,$(subst G,g,$(subst H,h,$(subst I,i,$(subst J,j,$(subst K,k,$(subst L,l,$(subst M,m,$(subst N,n,$(subst O,o,$(subst P,p,$(subst Q,q,$(subst R,r,$(subst S,s,$(subst T,t,$(subst U,u,$(subst V,v,$(subst W,w,$(subst X,x,$(subst Y,y,$(subst Z,z,$1))))))))))))))))))))))))))

#Project config parameters that are accessed by Eclipse
DATABASE = database 
DATABASECREATEKEYS = 
MAKMAKOPTIONS = 
EXTRA_CC_FLAGS = 
EXTRA_LIBS = 
LD_FLAGS = 
COMPILER = GCC
PREBUILD = ../prebuild.tcl
POSTBUILD = ../postbuild.tcl
COMPILER_LO = $(call lc,$(COMPILER))

BIN_DIR = 
USERLIB_DLL = 
CC = ucfront-gcc gcc
CC_FLAGS = -g -Wall -O2 -fomit-frame-pointer -pipe -msoft-float -fno-builtin -DEMBED -fno-strict-aliasing
LD	= $(CC) -Wl,-elf2flt -msoft-float
LD_FLAGS =

all:

%:
	acplt_makmak -l wagoFBKlib $(MAKMAKOPTIONS)
	tclsh $(PREBUILD) wagoFBKlib $(MAKMAKOPTIONS)
	$(MAKE) NO_DLL_COPY=1 BIN_DIR='$(BIN_DIR)' USERLIB_DLL='$(USERLIB_DLL)' CC='$(CC)' CC_FLAGS='$(CC_FLAGS)' LD='$(LD)' LD_FLAGS='$(LD_FLAGS)' EXTRA_CC_FLAGS='$(EXTRA_CC_FLAGS)' EXTRA_LIBS='$(EXTRA_LIBS)' LD_FLAGS='$(LD_FLAGS)' TARGET='$*' -f $(call lc,$(COMPILER)).mk $*
	tclsh $(POSTBUILD) wagoFBKlib
